<!DOCTYPE html>
<html lang="uk">
<head>
    <title>Subscriptions</title>
    <style>
        .topic-item { margin-bottom: 10px; padding: 10px; border-bottom: 1px solid #ccc; }
        .sub { color: green; font-weight: bold; }
    </style>
</head>
<body>
<h1>Список тем</h1>

<fieldset>
    <legend>Створити нову тему</legend>
    <form method="post" action="{% url 'create_topic_view' %}">
        {% csrf_token %}
        <input type="text" name="name" placeholder="Назва теми" required>
        <button type="submit">Додати</button>
    </form>
</fieldset>

<hr>

{% for topic in all_topics %}
<div class="topic-item">
    <strong>{{ topic.name }}</strong>
    <span>(Підписників: {{ topic.subscribers.count }})</span>

    {% if topic in topics_us %} 
    <span class="sub">[Ви підписані]</span>
    <form method="post" action="{% url 'unsubscribe_view' topic.id %}" style="display:inline;">
        {% csrf_token %}
        <button type="submit">Відписатися</button>
    </form>
    {% else %}
    <form method="post" action="{% url 'subscribe_view' topic.id %}" style="display:inline;">
        {% csrf_token %}
        <button type="submit">Підписатися</button>
    </form>
    {% endif %}

    <form method="post" action="{% url 'delete_topic_view' topic.id %}" style="display:inline; margin-left: 20px;">
        {% csrf_token %}
        <button type="submit" onclick="return confirm('Видалити цю тему?')" style="color: red;">
            Видалити тему
        </button>
    </form>
</div>
{% empty %}
<p>Тем поки немає.</p>
{% endfor %}

</body>
</html>
